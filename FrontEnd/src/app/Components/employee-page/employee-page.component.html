
<app-navbar></app-navbar>
  <div class="d-flex">

   
  </div>







<div >
  <div id="buttons">
  <button class="btn btn-primary" (click)="viewEmployee()">New Employee</button>&nbsp;
  <button class="btn btn-primary" (click)="mapEmployee()">Existing Employee</button>
  </div>
  

  <div  *ngIf="flag1">

    <div class="container">
      <h4 align="center">Mapping new Employees</h4><br>
      <br>
      <table class="table  table-striped table-bordered">
        <thead>

          <tr scope="row">
            <td scope="col">First Name</td>
            <td scope="col">Last Name</td>
            <td scope="col">Email Name</td>
            <td scope="col">Mobile Number</td>
            <td scope="col">Configure</td>




          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let emp of employeeList" scope="row">
            <td scope="col">{{emp.userFirstName}}</td>
            <td scope="col">{{emp.userLastName}}</td>
            <td scope="col">{{emp.userEmailId}}</td>
            <td scope="col">{{emp.userMobileNumber}}</td>
            <td scope="col" data-bs-toggle="modal" data-bs-target="#exampleModal">&nbsp;&nbsp;<i
                (click)="dataCollect(emp)" class="fa fa-edit"></i></td>
          </tr>

        </tbody>
      </table>



    </div>


    <!--Update Model-->


    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Configure Employee</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <form [formGroup]="myForm" id="myform">



              <input type="text" class="form-control" formControlName="userFirstName"
                [placeholder]="employeeDetail.userFirstName " [(ngModel)]="employeeDetail.userFirstName " readonly>
              <div *ngIf="myForm.get('userFirstName')!.touched && myForm.get('userFirstName')!.invalid">

                <div *ngIf="myForm.get('userFirstName')!.hasError('required')">
                  <div id="condition">User ID is required</div>
                </div>
                <div *ngIf="myForm.get('userFirstName')!.hasError('pattern')">
                  <div id="condition"> Invalid User ID</div>

                </div>
              </div><br>








              <select class="form-select" name="Region" id="" formControlName="regionId"
                (change)=" getdepartment(myForm.value)">
                <option value="" disabled selected hidden>Select Region/Location</option>
                <option *ngFor="let reg of regList" [value]="reg.regionId">{{reg.regionName}}</option>
              </select>
              <br>

              <select class="form-select" id="inputSelectReason" class="form-control" formControlName="departmentId"
                (change)=" getproject(myForm.value)">
                <option value="" disabled selected hidden>Select Department</option>
                <option *ngFor="let dep of depList" [value]="dep.departmentId">{{dep.departmentName}}</option>
              </select>
              <br>


              <!-- <select class="form-select" id="inputSelectReason" class="form-control" formArrayName="project" multiple >
                        <option value="" disabled >Select Project</option>
                        <option *ngFor="let project of projectList1" [value]="project.projectId">{{project.projectName}}</option>
                      </select> -->

              <!-- <div formArrayName="project">
                        <div *ngFor="let control of project.controls;let i=index">
                     
                             <select [formControlName]="i">
                               <option  *ngFor="let project of projectList1" [value]="project.projectId" >
                                {{project.projectName}}
                               </option>
                             </select>
                     
                        </div>
                     </div> -->
              <div formArrayName="project">
                <div>
                  <button type="button" (click)="addProject()" class="btn btn-primary">
                    Add project

                  </button>
                </div>

                <div class="form-group" *ngFor="let project of projectControl;let i=index">

                  <!-- <select [formControlName]="i" class="form-control">
                    <option *ngFor="let project of projectList1" [value]="project.projectId">
                      {{project.projectName}}
                    </option>
                  </select> -->

                  <table>
                    <tr>
                      <td>
                        <select [formControlName]="i" class="form-control">
                          <option *ngFor="let project of projectList1" [value]="project.projectId">
                            {{project.projectName}}
                          </option>
      
                         
                        </select>
                        <br>
      

                      </td>
                      <td>

                        <button  *ngIf="i>0" class="btn btn-danger btn-sm" (click)="removeProject(i)">Remove </button>

                      </td>
                    </tr>
                  </table>
                </div>

              </div>




            </form>



            <p>{{result}}</p>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="update(myForm.value)" [disabled]="!myForm.valid">Submit</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12" *ngIf="flag">
    <div class="container">
      <h4 align="center">Mapping Existing Employees</h4><br>
      <br>
      <table class="table  table-striped table-bordered">
        <thead>

          <tr scope="row">
            <td scope="col">user Id</td>
            <td scope="col">First Name</td>
            <td scope="col">Last Name</td>
            <td scope="col">Email Name</td>
            <td scope="col">Mobile Number</td>
            
            <td scope="col">Region Name</td>
            <td scope="col">Department Name</td>
            <td scope="col">Department Id</td>
            <!-- <td scope="col">Project Name</td> -->
            <td scope="col">Configure</td>




          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let emp of employeeList1" scope="row">
            <td scope="col">{{emp.userId}}</td>
            <td scope="col">{{emp.userFirstName}}</td>
            <td scope="col">{{emp.userLastName}}</td>
            <td scope="col">{{emp.userEmailId}}</td>
            <td scope="col">{{emp.userMobileNumber}}</td>
            <td scope="col">{{emp.regionName}}</td>
            <td scope="col">{{emp.departmentName}}</td>
            <td scope="col">{{emp.department}}</td>
            <!-- <td scope="col">{{emp.projectName}}</td> -->
                <td scope="col" data-bs-toggle="modal" data-bs-target="#exampleModal">&nbsp;&nbsp;<i
                  (click)="dataCollect(emp)"  class="fa fa-edit"></i></td>
          </tr>

        </tbody>
      </table>



    </div>


    <!--Update Model-->


    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Configure Employee</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <form [formGroup]="myForm" id="myform">



              <input type="text" class="form-control" formControlName="userFirstName"
                [placeholder]="employeeDetail.userFirstName " [(ngModel)]="employeeDetail.userFirstName " readonly>
              <div *ngIf="myForm.get('userFirstName')!.touched && myForm.get('userFirstName')!.invalid">

                <div *ngIf="myForm.get('userFirstName')!.hasError('required')">
                  <div id="condition">User ID is required</div>
                </div>
                <div *ngIf="myForm.get('userFirstName')!.hasError('pattern')">
                  <div id="condition"> Invalid User ID</div>

                </div>
              </div><br>




  



              <select class="form-control" name="Region" id="inputSelectReason" formControlName="regionId"  
                (change)="getdepartment(myForm.value)">
                <option value="" disabled selected hidden>Select Region/Location</option>
                <option *ngFor="let reg of regList" [value]="reg.regionId">{{reg.regionName}}</option>
              </select>
              <br>

              <select class="form-select" id="inputSelectReason" class="form-control" formControlName="departmentId"  
                (change)=" getproject(myForm.value)">
                <option value="" disabled selected hidden>Select Department</option>
                <option *ngFor="let dep of depList" [value]="dep.departmentId">{{dep.departmentName}}</option>
              </select>
              <br>


              <!-- <select class="form-select" id="inputSelectReason" class="form-control" formArrayName="project" multiple >
                        <option value="" disabled >Select Project</option>
                        <option *ngFor="let project of projectList1" [value]="project.projectId">{{project.projectName}}</option>
                      </select> -->

              <!-- <div formArrayName="project">
                        <div *ngFor="let control of project.controls;let i=index">
                     
                             <select [formControlName]="i">
                               <option  *ngFor="let project of projectList1" [value]="project.projectId" >
                                {{project.projectName}}
                               </option>
                             </select>
                     
                        </div>
                     </div> -->
              <div formArrayName="project">
                <div>
                  <button type="button" (click)="addProject()" class="btn btn-primary"
                  >
                    Add project

                  </button>
                  <br>
                  
                </div>

                <div class="form-group" *ngFor="let project of projectControl;let i=index">

                  <table>
                    <tr>
                      <td>
                        <select [formControlName]="i" class="form-control">
                          <option *ngFor="let project of projectList1" [value]="project.projectId">
                            {{project.projectName}}
                          </option>
      
                         
                        </select>
                        <br>
      

                      </td>
                      <td>

                        <button  *ngIf="i>0" class="btn btn-danger btn-sm" (click)="removeProject(i)">Remove </button>

                      </td>
                    </tr>
                  </table>
                  
               
                  

                  <!-- <input type="text" class="form-control" [formControlName]="i" /> -->
                </div>

              </div>




            </form>



            <p>{{result}}</p>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="update(myForm.value)" [disabled]="!myForm.valid">Submit</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

          </div>
        </div>
      </div>
    </div>

  </div>
</div>